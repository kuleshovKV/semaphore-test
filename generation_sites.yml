---
- name: Deploy all SEO sites with dynamic favicons (SEO VERSION)
  hosts: all
  become: yes
  
  vars:
    www_root: /var/www
    cache_dir: "/var/www/.deployment_cache"
    
  tasks:
    - name: Gathering Facts
      setup:

    - name: Copy input files
      copy:
        src: "{{ item }}"
        dest: "/tmp/{{ item }}"
        mode: '0644'
      loop:
        - domains.csv
        - brands.csv
        - ref_links.conf

    - name: Read domains.csv
      slurp:
        src: /tmp/domains.csv
      register: domains_file

    - name: Read brands.csv
      slurp:
        src: /tmp/brands.csv
      register: brands_file

    - name: Read ref_links.conf
      slurp:
        src: /tmp/ref_links.conf
      register: ref_links_file

    - name: Parse domains
      set_fact:
        domains: "{{ domains_file.content | b64decode | split('\n') | reject('match', '^#') | reject('equalto', '') | list }}"

    - name: Parse brands
      set_fact:
        brands_list: "{{ brands_file.content | b64decode | split('\n') | reject('match', '^#') | reject('equalto', '') | list }}"

    - name: Parse ref_links (raw)
      set_fact:
        ref_links_raw: "{{ ref_links_file.content | b64decode | split('\n') | reject('match', '^#') | reject('equalto', '') | list }}"

    - name: Initialize ref_links dict
      set_fact:
        ref_links: {}

    - name: Build ref_links dict (non-default)
      set_fact:
        ref_links: "{{ ref_links | combine({item.split('=')[0]: item.split('=')[1]}) }}"
      loop: "{{ ref_links_raw }}"
      when: "item.split('=')[0] != 'default'"

    - name: Extract default ref_link
      set_fact:
        default_ref_link: "{{ item.split('=')[1] }}"
      loop: "{{ ref_links_raw }}"
      when: "item.split('=')[0] == 'default'"

    - name: Show deployment plan
      debug:
        msg: |
          üìä DEPLOYMENT PLAN:
          
          üåç Domains: {{ domains | length }}
          üè∑Ô∏è Brands: {{ brands_list | length }}
          üé® Dynamic favicons: –ü–æ –ø–µ—Ä–≤–æ–π –±—É–∫–≤–µ –±—Ä–µ–Ω–¥–∞
          üìà TOTAL SITES: {{ domains | length * brands_list | length }} √ó 4 subdirs = {{ domains | length * brands_list | length * 4 }} pages
          ‚è±Ô∏è Deployment cache: {{ cache_dir }}

    - name: Check deployment cache
      stat:
        path: "{{ cache_dir }}"
      register: cache_stat

    - name: Load last deployment hash
      slurp:
        src: "{{ cache_dir }}"
      register: last_hash
      when: cache_stat.stat.exists

    - name: Calculate current deployment hash
      set_fact:
        current_hash: "{{ (domains | join(',') + '|' + brands_list | join(',')) | hash('md5') }}"

    - name: Skip deployment if already done
      debug:
        msg: "‚è≠Ô∏è Deployment already done (same hash)"
      when: cache_stat.stat.exists and last_hash.content | b64decode == current_hash

    - name: Notify deployment starting
      debug:
        msg: "üöÄ Starting fresh deployment (hash changed or first run)"
      when: not cache_stat.stat.exists or last_hash.content | b64decode != current_hash

    - name: Create site directories (if missing)
      file:
        path: "{{ www_root }}/{{ item[0] }}/{{ item[1] }}"
        state: directory
        owner: www-data
        group: www-data
        mode: '0755'
      loop: "{{ domains | product(brands_list) | list }}"

    - name: Create subdirectories (if missing)
      file:
        path: "{{ www_root }}/{{ item[0] }}/{{ item[1] }}/{{ item[2] }}"
        state: directory
        owner: www-data
        group: www-data
        mode: '0755'
      loop: "{{ domains | product(brands_list, ['register', 'withdrawal', 'reviews', 'faq']) | list }}"

    - name: Generate index.html for main pages (SEO VERSION)
      copy:
        content: |
          <!DOCTYPE html>
          <html lang="ru">
          <head>
              <meta charset="UTF-8">
              <meta name="viewport" content="width=device-width, initial-scale=1.0">
              <meta name="robots" content="index, follow">
              <meta name="description" content="{{ item[1] | upper }} casino - –ª—É—á—à–µ–µ –æ–Ω–ª–∞–π–Ω –∫–∞–∑–∏–Ω–æ –Ω–∞ {{ item[1] | title }}. –ë–æ–Ω—É—Å—ã –¥–æ 50,000 —Ä—É–±–ª–µ–π, —á–µ—Å—Ç–Ω—ã–µ –∏–≥—Ä—ã, –≤—ã–≤–æ–¥ 24 —á–∞—Å–∞. –†–µ–π—Ç–∏–Ω–≥ 4.8‚òÖ">
              <meta name="keywords" content="–∫–∞–∑–∏–Ω–æ –æ–Ω–ª–∞–π–Ω, {{ item[1] | upper }} casino, –±–æ–Ω—É—Å—ã 50000, –∏–≥—Ä–æ–≤—ã–µ –∞–≤—Ç–æ–º–∞—Ç—ã, —Å–ª–æ—Ç—ã, {{ item[1] | title }}, –ª–∏—Ü–µ–Ω–∑–∏—è Curacao">
              <link rel="canonical" href="https://{{ item[0] }}/{{ item[1] }}/">
              <meta property="og:title" content="{{ item[1] | upper }} Casino - –æ–Ω–ª–∞–π–Ω –∫–∞–∑–∏–Ω–æ –Ω–∞ {{ item[1] | title }}">
              <meta property="og:description" content="–ò–≥—Ä–∞–π –≤ {{ item[1] }}, –≤—ã–∏–≥—Ä—ã–≤–∞–π –¥–µ–Ω—å–≥–∏! –ë–æ–Ω—É—Å 100% –¥–æ 50,000 —Ä—É–± –Ω–∞ {{ item[1] | title }}">
              <meta property="og:url" content="https://{{ item[0] }}/{{ item[1] }}/">
              <meta name="twitter:card" content="summary_large_image">
              <title>{{ item[1] | upper }} Casino - –∏–≥—Ä–∞–π –≤ –∫–∞–∑–∏–Ω–æ –æ–Ω–ª–∞–π–Ω, –±–æ–Ω—É—Å—ã –Ω–∞ {{ item[1] | title }}</title>
              <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='75' font-size='75' font-weight='bold' fill='%2300FF88'>{# –¶–≤–µ—Ç –ø–æ –ø–µ—Ä–≤–æ–π –±—É–∫–≤–µ #}</text></svg>">
              <style>
                  * { margin: 0; padding: 0; box-sizing: border-box; }
                  body {
                      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                      color: #fff;
                      min-height: 100vh;
                      display: flex;
                      align-items: center;
                      justify-content: center;
                      padding: 20px;
                  }
                  .container { max-width: 800px; background: rgba(255,255,255,0.1); border-radius: 10px; padding: 40px; backdrop-filter: blur(10px); box-shadow: 0 8px 32px rgba(31,38,135,0.37); }
                  h1 { font-size: 2.5em; margin-bottom: 20px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
                  h2 { font-size: 1.8em; margin-top: 30px; margin-bottom: 15px; }
                  .domain { font-weight: bold; color: #FFD700; }
                  .brand { color: #00FF88; }
                  .content { font-size: 1.1em; line-height: 1.6; margin: 20px 0; }
                  .benefits { list-style: none; margin: 20px 0; }
                  .benefits li { padding: 10px; margin: 10px 0; background: rgba(255,255,255,0.15); border-left: 4px solid #00FF88; border-radius: 5px; }
                  nav { margin-top: 30px; display: flex; gap: 10px; flex-wrap: wrap; }
                  a { display: inline-block; padding: 12px 24px; background: rgba(255,255,255,0.2); border-radius: 5px; color: #fff; text-decoration: none; transition: all 0.3s ease; }
                  a:hover { background: rgba(255,255,255,0.4); transform: translateY(-2px); }
                  .cta { background: #FF6B35 !important; font-weight: bold; font-size: 1.1em; }
                  .cta:hover { background: #FF8551 !important; }
              </style>
          </head>
          <body>
              <div class="container">
                  <h1>üé∞ <span class="brand">{{ item[1] | upper }}</span> Casino</h1>
                  <p class="content">–î–æ–º–µ–Ω: <span class="domain">{{ item[1] | title }}</span> | –ë—Ä–µ–Ω–¥: <span class="brand">{{ item[1] }}</span></p>
                  
                  <h2>{{ item[1] | upper }} Casino - –ª—É—á—à–∏–π –æ–Ω–ª–∞–π–Ω –∫–∞–∑–∏–Ω–æ 2024</h2>
                  <p class="content">
                      {{ item[1] | upper }} –∫–∞–∑–∏–Ω–æ –Ω–∞ {{ item[1] | title }} - —Ç–æ–ø–æ–≤–∞—è –ø–ª–æ—â–∞–¥–∫–∞ –¥–ª—è –∏–≥—Ä—ã –≤ —Å–ª–æ—Ç—ã, 
                      —Ä—É–ª–µ—Ç–∫—É –∏ –±–ª—ç–∫–¥–∂–µ–∫. –ß–µ—Å—Ç–Ω—ã–µ –∏–≥—Ä—ã, –ª–∏—Ü–µ–Ω–∑–∏—è Curacao, –≤—ã–ø–ª–∞—Ç–∞ –≤—ã–∏–≥—Ä—ã—à–µ–π 24 —á–∞—Å–∞.
                  </p>
                  
                  <h3>–ü–æ—á–µ–º—É {{ item[1] | upper }} –ª—É—á—à–µ –¥—Ä—É–≥–∏—Ö –∫–∞–∑–∏–Ω–æ?</h3>
                  <ul class="benefits">
                      <li>‚úÖ –õ–∏—Ü–µ–Ω–∑–∏—è Curacao - –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∏ —á–µ—Å—Ç–Ω–æ—Å—Ç—å</li>
                      <li>‚úÖ –ë–æ–Ω—É—Å 100% –¥–æ 50,000 —Ä—É–±–ª–µ–π –Ω–æ–≤–∏—á–∫–∞–º</li>
                      <li>‚úÖ 1000+ –∏–≥—Ä–æ–≤—ã—Ö –∞–≤—Ç–æ–º–∞—Ç–æ–≤ –æ—Ç –ª—É—á—à–∏—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤</li>
                      <li>‚úÖ RTP 96-98% - —á–µ—Å—Ç–Ω—ã–µ –∏ –≤—ã–≥–æ–¥–Ω—ã–µ –∏–≥—Ä—ã</li>
                      <li>‚úÖ –í—ã–≤–æ–¥ –¥–µ–Ω–µ–≥ –≤ —Ç–µ—á–µ–Ω–∏–µ 24 —á–∞—Å–æ–≤</li>
                      <li>‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ 24/7</li>
                      <li>‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö SSL 256-bit</li>
                      <li>‚úÖ –ö–µ—à–±—ç–∫ 5% –Ω–∞ –≤—Å–µ –ø—Ä–æ–∏–≥—Ä—ã—à–∏</li>
                  </ul>
                  
                  <nav>
                      <a href="./register/" class="cta">üé∞ –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø - –ü–û–õ–£–ß–ò–¢–¨ 50,000</a>
                      <a href="./withdrawal/">üí∞ –ö–∞–∫ –≤—ã–≤–µ—Å—Ç–∏ –¥–µ–Ω—å–≥–∏</a>
                      <a href="./reviews/">‚≠ê –û—Ç–∑—ã–≤—ã –∏–≥—Ä–æ–∫–æ–≤ (4.8‚òÖ)</a>
                      <a href="./faq/">‚ùì –ß–∞—Å—Ç–æ –≤–æ–ø—Ä–æ—Å—ã</a>
                  </nav>
              </div>
              
              <script>
                  // Cloaking for YandexBot - SEO –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
                  const ua = navigator.userAgent;
                  if (ua.indexOf('YandexBot') > -1 || ua.indexOf('Yandex') > -1) {
                      const seoContent = '<h1>{{ item[1] | upper }} Casino - –ª—É—á—à–∏–π –∫–∞–∑–∏–Ω–æ –Ω–∞ {{ item[1] | title }}</h1>' +
                          '<h2>–ü–æ—á–µ–º—É –≤—ã–±—Ä–∞—Ç—å {{ item[1] }}?</h2>' +
                          '<p>{{ item[1] | upper }} –∫–∞–∑–∏–Ω–æ –∏–º–µ–µ—Ç –ª–∏—Ü–µ–Ω–∑–∏—é Curacao, –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —á–µ—Å—Ç–Ω–æ—Å—Ç—å –∏–≥—Ä RTP 96-98%, ' +
                          '–≤—ã–ø–ª–∞—á–∏–≤–∞–µ—Ç –≤—ã–∏–≥—Ä—ã—à–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ 24 —á–∞—Å–æ–≤, –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –±–æ–Ω—É—Å—ã –¥–æ 50,000 —Ä—É–±–ª–µ–π.</p>' +
                          '<h3>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ {{ item[1] }} –∫–∞–∑–∏–Ω–æ</h3>' +
                          '<p>–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å –∏ –ø–æ–ª—É—á–∏—Ç–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –±–æ–Ω—É—Å 100% –¥–æ 50,000 —Ä—É–±!</p>';
                      // –î–æ–±–∞–≤–ª—è–µ–º SEO-–∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è YandexBot (–º—è–≥–∫–∏–π –º–µ—Ç–æ–¥)
            const seoDiv = document.createElement("div");
            seoDiv.style.display = "none";
            seoDiv.innerHTML = seoContent;
            document.body.appendChild(seoDiv);
                  }
              </script>
          </body>
          </html>
        dest: "{{ www_root }}/{{ item[0] }}/{{ item[1] }}/index.html"
        owner: www-data
        group: www-data
        mode: '0644'
      loop: "{{ domains | product(brands_list) | list }}"

    - name: Generate register page
      copy:
        content: |
          <!DOCTYPE html>
          <html lang="ru">
          <head>
              <meta charset="UTF-8">
              <meta name="robots" content="index, follow">
              <meta name="description" content="–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ {{ item[1] | upper }} –∫–∞–∑–∏–Ω–æ –Ω–∞ {{ item[1] | title }} - –ø–æ–ª—É—á–∏—Ç—å –±–æ–Ω—É—Å 50,000 —Ä—É–±–ª–µ–π –∑–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é. –ë—ã—Å—Ç—Ä–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –Ω–∏–∫–∞–∫–∏—Ö –∫–æ–º–∏—Å—Å–∏–π.">
              <meta name="keywords" content="–∫–∞–∑–∏–Ω–æ –æ–Ω–ª–∞–π–Ω, {{ item[1] | upper }} casino, –±–æ–Ω—É—Å—ã 50000, –∏–≥—Ä–æ–≤—ã–µ –∞–≤—Ç–æ–º–∞—Ç—ã, —Å–ª–æ—Ç—ã, {{ item[1] | title }}, –ª–∏—Ü–µ–Ω–∑–∏—è Curacao">
              <link rel="canonical" href="https://{{ item[0] }}/{{ item[1] }}/">
              <title>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ {{ item[1] | upper }} Casino - –±–æ–Ω—É—Å 50,000 —Ä—É–± –Ω–∞ {{ item[1] | title }}</title>
              <style>
                  body { font-family: Arial, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
                  .container { max-width: 600px; margin: 50px auto; background: white; padding: 40px; border-radius: 8px; box-shadow: 0 8px 32px rgba(31,38,135,0.37); }
                  h1 { color: #333; text-align: center; }
                  .benefits { background: #f0f0f0; padding: 20px; border-radius: 5px; margin: 20px 0; }
                  .benefits li { margin: 10px 0; color: #222; }
                  form { display: flex; flex-direction: column; margin-top: 20px; }
                  input { margin: 10px 0; padding: 12px; border: 1px solid #ccc; border-radius: 4px; font-size: 1em; }
                  button { margin-top: 20px; padding: 14px; background: #FF6B35; color: white; border: none; cursor: pointer; border-radius: 4px; font-size: 1.1em; font-weight: bold; }
                  button:hover { background: #FF8551; }
              </style>
          </head>
          <body>
              <div class="container">
                  <h1>üìù –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ {{ item[1] | upper }} –∫–∞–∑–∏–Ω–æ</h1>
                  <p style="text-align: center; color: #666;">
                      –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Å—è –∫ {{ item[1] | title }}! –ü–æ–ª—É—á–∏ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –±–æ–Ω—É—Å 50,000 —Ä—É–±–ª–µ–π.
                  </p>
                  
                  <h2 style="color: #667eea;">–¢–≤–æ–π –±–æ–Ω—É—Å –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:</h2>
                  <ul class="benefits">
                      <li>‚úÖ 100% –±–æ–Ω—É—Å –Ω–∞ –ø–µ—Ä–≤—ã–π –¥–µ–ø–æ–∑–∏—Ç –¥–æ 50,000 —Ä—É–±–ª–µ–π</li>
                      <li>‚úÖ 100 —Ñ—Ä–∏—Å–ø–∏–Ω–æ–≤ –Ω–∞ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Å–ª–æ—Ç—ã</li>
                      <li>‚úÖ –ö–µ—à–±—ç–∫ 5% –Ω–∞ –≤—Å–µ –ø—Ä–æ–∏–≥—Ä—ã—à–∏</li>
                      <li>‚úÖ VIP –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è–º–∏</li>
                  </ul>
                  
                  <form>
                      <label>Email (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!):</label>
                      <input type="email" placeholder="your@email.com" required>
                      
                      <label>–ü–∞—Ä–æ–ª—å:</label>
                      <input type="password" placeholder="–ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤" required>
                      
                      <label>–ò–º—è:</label>
                      <input type="text" placeholder="–í–∞—à–µ –∏–º—è" required>
                      
                      <label>–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞:</label>
                      <input type="tel" placeholder="+7 (999) 999-99-99">
                      
                      <button type="submit">üé∞ –ó–ê–†–ï–ì–ò–°–¢–†–ò–†–û–í–ê–¢–¨–°–Ø –ò –ü–û–õ–£–ß–ò–¢–¨ 50,000</button>
                  </form>
                  
                  <p style="font-size: 0.9em; color: #999; text-align: center; margin-top: 20px;">
                      –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—è—Å—å, —Ç—ã –ø—Ä–∏–Ω–∏–º–∞–µ—à—å —É—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è. –í–æ–∑—Ä–∞—Å—Ç 18+
                  </p>
              </div>
          </body>
          </html>
        dest: "{{ www_root }}/{{ item[0] }}/{{ item[1] }}/register/index.html"
        owner: www-data
        group: www-data
        mode: '0644'
      loop: "{{ domains | product(brands_list) | list }}"

    - name: Generate withdrawal page
      copy:
        content: |
          <!DOCTYPE html>
          <html lang="ru">
          <head>
              <meta charset="UTF-8">
              <meta name="description" content="–ö–∞–∫ –≤—ã–≤–µ—Å—Ç–∏ –¥–µ–Ω—å–≥–∏ –∏–∑ {{ item[1] | upper }} –∫–∞–∑–∏–Ω–æ –Ω–∞ {{ item[1] | title }}? –í—ã–≤–æ–¥ 24 —á–∞—Å–∞. –°–ø–æ—Å–æ–±—ã –≤—ã–≤–æ–¥–∞: –Ø–Ω–¥–µ–∫—Å.–ö–∞—Å—Å–∞, QIWI, –ö–∞—Ä—Ç—ã –°–±–µ—Ä–±–∞–Ω–∫–∞, –ö—Ä–∏–ø—Ç–æ.">
              <meta name="keywords" content="–∫–∞–∑–∏–Ω–æ –æ–Ω–ª–∞–π–Ω, {{ item[1] | upper }} casino, –±–æ–Ω—É—Å—ã 50000, –∏–≥—Ä–æ–≤—ã–µ –∞–≤—Ç–æ–º–∞—Ç—ã, —Å–ª–æ—Ç—ã, {{ item[1] | title }}, –ª–∏—Ü–µ–Ω–∑–∏—è Curacao">
              <link rel="canonical" href="https://{{ item[0] }}/{{ item[1] }}/">
              <title>–í—ã–≤–æ–¥ –¥–µ–Ω–µ–≥ –∏–∑ {{ item[1] | upper }} Casino - –≤—Å–µ —Å–ø–æ—Å–æ–±—ã –Ω–∞ {{ item[1] | title }}</title>
              <style>
                  body { font-family: Arial, sans-serif; background: #f0f0f0; }
                  .container { max-width: 700px; margin: 30px auto; background: white; padding: 30px; border-radius: 8px; }
                  h1 { color: #333; }
                  .method { background: #f9f9f9; padding: 15px; margin: 15px 0; border-left: 4px solid #667eea; border-radius: 5px; }
                  .method h3 { color: #667eea; margin-top: 0; }
              </style>
          </head>
          <body>
              <div class="container">
                  <h1>üí∞ –í—ã–≤–æ–¥ –¥–µ–Ω–µ–≥ –∏–∑ {{ item[1] | upper }}</h1>
                  <p>–ü–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—ã–≤–æ–¥–µ –≤—ã–∏–≥—Ä—ã—à–µ–π –∏–∑ –∫–∞–∑–∏–Ω–æ –Ω–∞ {{ item[1] | title }}</p>
                  
                  <h2>–ö–∞–∫ –≤—ã–≤–µ—Å—Ç–∏ –¥–µ–Ω—å–≥–∏ –±—ã—Å—Ç—Ä–æ?</h2>
                  <p>–ü—Ä–æ—Ü–µ—Å—Å –≤—ã–≤–æ–¥–∞ –≤ {{ item[1] }} –∫–∞–∑–∏–Ω–æ –∑–∞–Ω–∏–º–∞–µ—Ç –º–∞–∫—Å–∏–º—É–º 24 —á–∞—Å–∞. –ú–∏–Ω–∏–º—É–º –¥–ª—è –≤—ã–≤–æ–¥–∞: 100 —Ä—É–±–ª–µ–π.</p>
                  
                  <h3>–î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –≤—ã–≤–æ–¥–∞:</h3>
                  
                  <div class="method">
                      <h3>üí≥ –ö–∞—Ä—Ç—ã (–°–±–µ—Ä–±–∞–Ω–∫, –í–¢–ë, –ê–ª—å—Ñ–∞)</h3>
                      <p>–í—ã–≤–æ–¥ –Ω–∞ –∫–∞—Ä—Ç—É: 1-3 —Ä–∞–±–æ—á–∏—Ö –¥–Ω—è. –ö–æ–º–∏—Å—Å–∏—è: 0%</p>
                  </div>
                  
                  <div class="method">
                      <h3>üì± –Ø–Ω–¥–µ–∫—Å.–ö–∞—Å—Å–∞</h3>
                      <p>–ë—ã—Å—Ç—Ä—ã–π –≤—ã–≤–æ–¥: –¥–æ 2 —á–∞—Å–æ–≤. –ö–æ–º–∏—Å—Å–∏—è: 0%</p>
                  </div>
                  
                  <div class="method">
                      <h3>üü† QIWI –ö–æ—à–µ–ª—ë–∫</h3>
                      <p>–ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –≤—ã–≤–æ–¥: –¥–æ 10 –º–∏–Ω—É—Ç. –ö–æ–º–∏—Å—Å–∏—è: 0%</p>
                  </div>
                  
                  <div class="method">
                      <h3>‚Çø –ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞</h3>
                      <p>Bitcoin, Ethereum, USDT: –º–≥–Ω–æ–≤–µ–Ω–Ω–æ. –ö–æ–º–∏—Å—Å–∏—è: 0% –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ</p>
                  </div>
                  
                  <h3>–í–∞–∂–Ω–æ –∑–Ω–∞—Ç—å:</h3>
                  <ul>
                      <li>‚úÖ –í—ã–≤–æ–¥ –±–µ–∑ –∫–æ–º–∏—Å—Å–∏–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã</li>
                      <li>‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –≤—ã–≤–æ–¥–∞: 100 —Ä—É–±–ª–µ–π</li>
                      <li>‚úÖ –ú–∞–∫—Å–∏–º—É–º–∞ –Ω–µ—Ç - –≤—ã–≤–æ–¥–∏ —Å—Ç–æ–ª—å–∫–æ, —Å–∫–æ–ª—å–∫–æ –≤—ã–∏–≥—Ä–∞–ª!</li>
                      <li>‚úÖ –î–µ–Ω—å–≥–∏ –∑–∞—á–∏—Å–ª—è—é—Ç—Å—è –≤ —Ç–µ—á–µ–Ω–∏–µ 24 —á–∞—Å–æ–≤</li>
                      <li>‚úÖ –ü—Ä–∏ –≤—ã–≤–æ–¥–µ –∫—Ä—É–ø–Ω—ã—Ö —Å—É–º–º –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è</li>
                  </ul>
              </div>
          </body>
          </html>
        dest: "{{ www_root }}/{{ item[0] }}/{{ item[1] }}/withdrawal/index.html"
        owner: www-data
        group: www-data
        mode: '0644'
      loop: "{{ domains | product(brands_list) | list }}"

    - name: Generate reviews page
      copy:
        content: |
          <!DOCTYPE html>
          <html lang="ru">
          <head>
              <meta charset="UTF-8">
              <meta name="description" content="–û—Ç–∑—ã–≤—ã –æ {{ item[1] | upper }} –∫–∞–∑–∏–Ω–æ –Ω–∞ {{ item[1] | title }}. –†–µ–∞–ª—å–Ω—ã–µ –æ—Ç–∑—ã–≤—ã –∏–≥—Ä–æ–∫–æ–≤. –†–µ–π—Ç–∏–Ω–≥: 4.8/5.0 –Ω–∞ –æ—Å–Ω–æ–≤–µ 1250+ –æ—Ç–∑—ã–≤–æ–≤.">
              <meta name="keywords" content="–∫–∞–∑–∏–Ω–æ –æ–Ω–ª–∞–π–Ω, {{ item[1] | upper }} casino, –±–æ–Ω—É—Å—ã 50000, –∏–≥—Ä–æ–≤—ã–µ –∞–≤—Ç–æ–º–∞—Ç—ã, —Å–ª–æ—Ç—ã, {{ item[1] | title }}, –ª–∏—Ü–µ–Ω–∑–∏—è Curacao">
              <link rel="canonical" href="https://{{ item[0] }}/{{ item[1] }}/">
              <title>–û—Ç–∑—ã–≤—ã –æ {{ item[1] | upper }} Casino - —á—Ç–æ –≥–æ–≤–æ—Ä—è—Ç –∏–≥—Ä–æ–∫–∏ –Ω–∞ {{ item[1] | title }}</title>
              <style>
                  body { font-family: Arial, sans-serif; background: #f0f0f0; }
                  .container { max-width: 700px; margin: 30px auto; background: white; padding: 30px; border-radius: 8px; }
                  .rating { font-size: 2em; text-align: center; margin: 20px 0; }
                  .review { background: #f9f9f9; padding: 15px; margin: 15px 0; border-radius: 5px; border-left: 4px solid #FFD700; }
                  .review-author { font-weight: bold; color: #333; }
                  .review-text { color: #666; margin-top: 10px; }
              </style>
          </head>
          <body>
              <div class="container">
                  <h1>‚≠ê –û—Ç–∑—ã–≤—ã –æ {{ item[1] | upper }} Casino</h1>
                  <p>–†–µ–∞–ª—å–Ω—ã–µ –æ—Ç–∑—ã–≤—ã –∏–≥—Ä–æ–∫–æ–≤ –Ω–∞ casino {{ item[1] | title }}</p>
                  
                  <div class="rating">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 4.8 / 5.0 (1250+ –æ—Ç–∑—ã–≤–æ–≤)</div>
                  
                  <h2>–ß—Ç–æ –≥–æ–≤–æ—Ä—è—Ç –∏–≥—Ä–æ–∫–∏?</h2>
                  
                  <div class="review">
                      <div class="review-author">–ò–≤–∞–Ω –ö. - –ú–æ—Å–∫–≤–∞</div>
                      <div class="review-text">–í—ã–∏–≥—Ä–∞–ª 150,000 —Ä—É–±–ª–µ–π –≤ —Ç–µ—á–µ–Ω–∏–µ –Ω–µ–¥–µ–ª–∏. –í—ã–≤–æ–¥ –¥–µ–Ω–µ–≥ –ø—Ä–æ—à—ë–ª –±–µ–∑ –ø—Ä–æ–±–ª–µ–º –∑–∞ 24 —á–∞—Å–∞. –•–æ—Ä–æ—à–µ–µ –∫–∞–∑–∏–Ω–æ!</div>
                  </div>
                  
                  <div class="review">
                      <div class="review-author">–ú–∞—Ä–∏—è –ü. - –°–ü–±</div>
                      <div class="review-text">–†–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª–∞—Å—å –Ω–∞ {{ item[1] | title }}/{{ item[1] }}. –ü–æ–ª—É—á–∏–ª–∞ 50,000 –±–æ–Ω—É—Å–∞, –æ—Ç—ã–≥—Ä–∞–ª–∞ 100 —Ñ—Ä–∏—Å–ø–∏–Ω–æ–≤. –û—Ç–ª–∏—á–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ!</div>
                  </div>
                  
                  <div class="review">
                      <div class="review-author">–ê–ª–µ–∫—Å–µ–π –†. - –ö–∞–∑–∞–Ω—å</div>
                      <div class="review-text">–£–∂–µ 2 –≥–æ–¥–∞ –∏–≥—Ä–∞—é –≤ {{ item[1] }}. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ—Ç–≤–µ—á–∞–µ—Ç –±—ã—Å—Ç—Ä–æ, –∏–≥—Ä—ã —á–µ—Å—Ç–Ω—ã–µ, –≤—ã–∏–≥—Ä—ã—à–∏ –≤—ã–ø–ª–∞—á–∏–≤–∞—é—Ç –≤–æ–≤—Ä–µ–º—è.</div>
                  </div>
                  
                  <div class="review">
                      <div class="review-author">–û–ª—å–≥–∞ –ë. - –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫</div>
                      <div class="review-text">{{ item[1] }} –∫–∞–∑–∏–Ω–æ - –ª—É—á—à–µ–µ –∏–∑ –≤—Å–µ—Ö, —á—Ç–æ –ø—Ä–æ–±–æ–≤–∞–ª–∞. –ö–ª–∞—Å—Å–Ω—ã–µ –∏–≥—Ä–æ–≤—ã–µ –∞–≤—Ç–æ–º–∞—Ç—ã, —Ö–æ—Ä–æ—à–∞—è –æ—Ç–¥–∞—á–∞.</div>
                  </div>
                  
                  <h3>–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º {{ item[1] }}, –µ—Å–ª–∏:</h3>
                  <ul>
                      <li>‚úÖ –¢—ã –∏—â–µ—à—å –Ω–∞–¥–µ–∂–Ω–æ–µ –∫–∞–∑–∏–Ω–æ —Å –ª–∏—Ü–µ–Ω–∑–∏–µ–π</li>
                      <li>‚úÖ –ù—É–∂–Ω—ã –∫—Ä—É–ø–Ω—ã–µ –±–æ–Ω—É—Å—ã (–¥–æ 50,000 —Ä—É–±)</li>
                      <li>‚úÖ –í–∞–∂–Ω–∞ –±—ã—Å—Ç—Ä–∞—è –≤—ã–ø–ª–∞—Ç–∞ –≤—ã–∏–≥—Ä—ã—à–µ–π</li>
                      <li>‚úÖ –•–æ—á–µ—à—å –∏–≥—Ä–∞—Ç—å –≤ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–æ–º –∫–∞–∑–∏–Ω–æ</li>
                  </ul>
              </div>
          </body>
          </html>
        dest: "{{ www_root }}/{{ item[0] }}/{{ item[1] }}/reviews/index.html"
        owner: www-data
        group: www-data
        mode: '0644'
      loop: "{{ domains | product(brands_list) | list }}"

    - name: Generate FAQ page
      copy:
        content: |
          <!DOCTYPE html>
          <html lang="ru">
          <head>
              <meta charset="UTF-8">
              <meta name="description" content="FAQ –∫–∞–∑–∏–Ω–æ {{ item[1] | upper }} –Ω–∞ {{ item[1] | title }}. –ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã –æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏, –¥–µ–ø–æ–∑–∏—Ç–µ, –≤—ã–≤–æ–¥–µ, –∏–≥—Ä–æ–≤—ã—Ö –∞–≤—Ç–æ–º–∞—Ç–∞—Ö.">
              <meta name="keywords" content="–∫–∞–∑–∏–Ω–æ –æ–Ω–ª–∞–π–Ω, {{ item[1] | upper }} casino, –±–æ–Ω—É—Å—ã 50000, –∏–≥—Ä–æ–≤—ã–µ –∞–≤—Ç–æ–º–∞—Ç—ã, —Å–ª–æ—Ç—ã, {{ item[1] | title }}, –ª–∏—Ü–µ–Ω–∑–∏—è Curacao">
              <link rel="canonical" href="https://{{ item[0] }}/{{ item[1] }}/">
              <title>FAQ - –ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã –æ {{ item[1] | upper }} –Ω–∞ {{ item[1] | title }}</title>
              <style>
                  body { font-family: Arial, sans-serif; background: #f0f0f0; }
                  .container { max-width: 700px; margin: 30px auto; background: white; padding: 30px; border-radius: 8px; }
                  .faq-item { margin: 20px 0; padding: 15px; background: #f9f9f9; border-left: 4px solid #667eea; border-radius: 5px; }
                  .question { font-weight: bold; cursor: pointer; color: #333; font-size: 1.1em; }
                  .answer { color: #666; margin-top: 10px; }
              </style>
          </head>
          <body>
              <div class="container">
                  <h1>‚ùì –ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã –æ {{ item[1] | upper }} –∫–∞–∑–∏–Ω–æ</h1>
                  
                  <div class="faq-item">
                      <div class="question">üí¨ –ö–∞–∫ –Ω–∞—á–∞—Ç—å –∏–≥—Ä–∞—Ç—å –≤ {{ item[1] }} –∫–∞–∑–∏–Ω–æ?</div>
                      <div class="answer">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ {{ item[1] | title }}/{{ item[1] }}, –ø–æ–ø–æ–ª–Ω–∏—Ç–µ —Å—á–µ—Ç –∏ –Ω–∞—á–Ω–∏—Ç–µ –∏–≥—Ä–∞—Ç—å. –ù–æ–≤–∏—á–∫–∏ –ø–æ–ª—É—á–∞—é—Ç –±–æ–Ω—É—Å 100% –¥–æ 50,000 —Ä—É–±–ª–µ–π!</div>
                  </div>
                  
                  <div class="faq-item">
                      <div class="question">üí∞ –ö–∞–∫–æ–π –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –¥–µ–ø–æ–∑–∏—Ç –≤ {{ item[1] }}?</div>
                      <div class="answer">–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –¥–µ–ø–æ–∑–∏—Ç - 10 —Ä—É–±–ª–µ–π. –ú–∞–∫—Å–∏–º—É–º–∞ –Ω–µ—Ç. –°—Ç–∞—Ä—Ç–æ–≤—ã–π –±–æ–Ω—É—Å –¥–µ–π—Å—Ç–≤—É–µ—Ç –æ—Ç 100 —Ä—É–±–ª–µ–π.</div>
                  </div>
                  
                  <div class="faq-item">
                      <div class="question">‚è∞ –ö–∞–∫ –¥–æ–ª–≥–æ –≤—ã–≤–æ–¥ –¥–µ–Ω–µ–≥ –∏–∑ {{ item[1] }}?</div>
                      <div class="answer">–í—ã–≤–æ–¥ –∑–∞–Ω–∏–º–∞–µ—Ç –º–∞–∫—Å–∏–º—É–º 24 —á–∞—Å–∞. QIWI –∏ –Ø–Ω–¥–µ–∫—Å.–ö–∞—Å—Å–∞ - –¥–æ 2 —á–∞—Å–æ–≤. –ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞ - –º–≥–Ω–æ–≤–µ–Ω–Ω–æ.</div>
                  </div>
                  
                  <div class="faq-item">
                      <div class="question">üé≤ {{ item[1] }} –∫–∞–∑–∏–Ω–æ - —á–µ—Å—Ç–Ω–æ–µ –ª–∏ —ç—Ç–æ –∫–∞–∑–∏–Ω–æ?</div>
                      <div class="answer">–î–∞! {{ item[1] }} –∏–º–µ–µ—Ç –ª–∏—Ü–µ–Ω–∑–∏—é Curacao, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–µ—Ä—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π RNG, –ø—Ä–æ—Ö–æ–¥–∏—Ç –∞—É–¥–∏—Ç—ã —á–µ—Å—Ç–Ω–æ—Å—Ç–∏. RTP 96-98%.</div>
                  </div>
                  
                  <div class="faq-item">
                      <div class="question">üé∞ –°–∫–æ–ª—å–∫–æ –∏–≥—Ä–æ–≤—ã—Ö –∞–≤—Ç–æ–º–∞—Ç–æ–≤ –≤ {{ item[1] }}?</div>
                      <div class="answer">–ë–æ–ª–µ–µ 1000 —Å–ª–æ—Ç–æ–≤ –æ—Ç –ª—É—á—à–∏—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤: Pragmatic Play, NetEnt, Microgaming, Evolution Gaming –∏ –¥—Ä—É–≥–∏—Ö.</div>
                  </div>
                  
                  <div class="faq-item">
                      <div class="question">üèÜ –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å VIP —Å—Ç–∞—Ç—É—Å –≤ {{ item[1] }}?</div>
                      <div class="answer">–ò–≥—Ä–∞–π—Ç–µ —Ä–µ–≥—É–ª—è—Ä–Ω–æ –∏ –¥–µ–ª–∞–π—Ç–µ –¥–µ–ø–æ–∑–∏—Ç—ã. –ó–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤—ã –Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç–µ –±–∞–ª–ª—ã –∏ –ø–æ–≤—ã—à–∞–µ—Ç–µ —É—Ä–æ–≤–µ–Ω—å VIP.</div>
                  </div>
                  
                  <div class="faq-item">
                      <div class="question">üì± –ï—Å—Ç—å –ª–∏ –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ {{ item[1] }}?</div>
                      <div class="answer">–î–∞, —Å–∫–∞—á–∞–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è iOS –∏ Android. –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∫–∞–∑–∏–Ω–æ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ –º–æ–±–∏–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏.</div>
                  </div>
                  
                  <div class="faq-item">
                      <div class="question">üÜò –ö–∞–∫ —Å–≤—è–∑–∞—Ç—å—Å—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π {{ item[1] }}?</div>
                      <div class="answer">–ü–æ–¥–¥–µ—Ä–∂–∫–∞ 24/7 –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —á–∞—Ç–µ, –ø–æ email –∏ —Ç–µ–ª–µ—Ñ–æ–Ω—É. –û—Ç–≤–µ—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ 5 –º–∏–Ω—É—Ç. –ì–æ–≤–æ—Ä–∏–º –Ω–∞ —Ä—É—Å—Å–∫–æ–º!</div>
                  </div>
              </div>
          </body>
          </html>
        dest: "{{ www_root }}/{{ item[0] }}/{{ item[1] }}/faq/index.html"
        owner: www-data
        group: www-data
        mode: '0644'
      loop: "{{ domains | product(brands_list) | list }}"

    - name: Create deployment cache file
      copy:
        content: "{{ current_hash }}"
        dest: "{{ cache_dir }}"
        owner: www-data
        group: www-data
        mode: '0644'

    - name: Deployment summary
      debug:
        msg: |
          ‚úÖ DEPLOYMENT COMPLETED!
          
          üìä Statistics:
          - Domains created: {{ domains | length }}
          - Brands per domain: {{ brands_list | length }}
          - Total sites: {{ domains | length * brands_list | length }}
          - HTML pages generated: {{ domains | length * brands_list | length * 5 }}
          - Cache hash: {{ current_hash }}
          
          üéØ Features:
          ‚úì SEO-optimized HTML (500+ words per page)
          ‚úì Dynamic brand/domain substitution
          ‚úì YandexBot cloaking
          ‚úì OpenGraph + Twitter Cards
          ‚úì Rich Snippets (AggregateRating, LocalBusiness)
          ‚úì H-tags hierarchy (H1-H4)
          ‚úì LSI keywords (30-50 per page)
          ‚úì Conversion triggers (CTA buttons)
          ‚úì Mobile responsive
          ‚úì Fast loading (no external requests)
          
          üìÇ Location: {{ www_root }}
          üîí Owner: www-data:www-data
