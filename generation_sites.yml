---
- hosts: all
  gather_facts: false
  
  tasks:
    # ========== –ö–û–ü–ò–†–£–ï–ú –§–ê–ô–õ–´ –ò–ó –†–ï–ü–û–ó–ò–¢–û–†–ò–Ø –í –†–ê–ë–û–ß–£–Æ –î–ò–†–ï–ö–¢–û–†–ò–Æ ==========
    - name: Copy domains.csv to working directory
      copy:
        src: "{{ playbook_dir }}/domains.csv"
        dest: "/tmp/domains.csv"
      delegate_to: localhost
      run_once: true

    - name: Copy brands.csv to working directory
      copy:
        src: "{{ playbook_dir }}/brands.csv"
        dest: "/tmp/brands.csv"
      delegate_to: localhost
      run_once: true

    - name: Copy ref_links.conf to working directory
      copy:
        src: "{{ playbook_dir }}/ref_links.conf"
        dest: "/tmp/ref_links.conf"
      delegate_to: localhost
      run_once: true

    # ========== –ó–ê–ì–†–£–ñ–ê–ï–ú –§–ê–ô–õ–´ ==========
    - name: Load domains
      slurp:
        src: "/tmp/domains.csv"
      register: domains_content
      delegate_to: localhost
      run_once: true

    - name: Load brands
      slurp:
        src: "/tmp/brands.csv"
      register: brands_content
      delegate_to: localhost
      run_once: true

    - name: Load ref_links
      slurp:
        src: "/tmp/ref_links.conf"
      register: ref_links_content
      delegate_to: localhost
      run_once: true

    # ========== –ü–ê–†–°–ò–ú –î–ê–ù–ù–´–ï ==========
    - name: Parse domains
      set_fact:
        domains: "{{ domains_content.content | b64decode | split('\n') | reject('equalto', '') | list }}"
      run_once: true

    - name: Parse brands
      set_fact:
        brands: "{{ brands_content.content | b64decode | split('\n') | reject('equalto', '') | list }}"
      run_once: true

    - name: Parse ref_links
      set_fact:
        ref_links: "{{ ref_links_content.content | b64decode | trim }}"
      run_once: true

    # ========== –ü–†–û–í–ï–†–Ø–ï–ú –ó–ê–ì–†–£–ñ–ï–ù–ù–´–ï –î–ê–ù–ù–´–ï ==========
    - name: Debug - Show domains
      debug:
        msg: "‚úÖ Domains loaded: {{ domains }}"
      run_once: true

    - name: Debug - Show brands
      debug:
        msg: "‚úÖ Brands loaded: {{ brands }}"
      run_once: true

    - name: Debug - Show ref_links
      debug:
        msg: "‚úÖ Ref links loaded ({{ ref_links | length }} chars)"
      run_once: true

    # ========== –°–û–ó–î–ê–Å–ú –í–°–ï –î–ò–†–ï–ö–¢–û–†–ò–ò ==========
    - name: Create main site directories
      file:
        path: "/var/www/{{ item[0] }}/{{ item[1] }}"
        state: directory
        owner: www-data
        group: www-data
        mode: '0755'
      loop: "{{ domains | product(brands) | list }}"

    - name: Create register directories
      file:
        path: "/var/www/{{ item[0] }}/{{ item[1] }}/register"
        state: directory
        owner: www-data
        group: www-data
        mode: '0755'
      loop: "{{ domains | product(brands) | list }}"

    - name: Create reviews directories
      file:
        path: "/var/www/{{ item[0] }}/{{ item[1] }}/reviews"
        state: directory
        owner: www-data
        group: www-data
        mode: '0755'
      loop: "{{ domains | product(brands) | list }}"

    - name: Create bonus directories
      file:
        path: "/var/www/{{ item[0] }}/{{ item[1] }}/bonus"
        state: directory
        owner: www-data
        group: www-data
        mode: '0755'
      loop: "{{ domains | product(brands) | list }}"

    - name: Create withdrawal directories
      file:
        path: "/var/www/{{ item[0] }}/{{ item[1] }}/withdrawal"
        state: directory
        owner: www-data
        group: www-data
        mode: '0755'
      loop: "{{ domains | product(brands) | list }}"

    # ===== 1. INDEX.HTML =====
    - name: Generate index.html
      copy:
        content: |
          <!DOCTYPE html>
          <html lang="ru">
          <head>
              <meta charset="UTF-8">
              <meta name="viewport" content="width=device-width, initial-scale=1.0">
              <meta name="robots" content="index, follow">
              <meta name="description" content="{{ item[1] | upper }} casino - –∏–≥—Ä–∞–π –æ–Ω–ª–∞–π–Ω, –±–æ–Ω—É—Å—ã 50000 —Ä—É–±, –≤—ã–≤–æ–¥ 24 —á–∞—Å–∞">
              <meta name="keywords" content="casino online, {{ item[1] | upper }} casino, –±–æ–Ω—É—Å—ã, —Å–ª–æ—Ç—ã">
              <link rel="canonical" href="https://{{ item[0] }}/{{ item[1] | lower }}/">
              <title>{{ item[1] | upper }} Casino - 50000 —Ä—É–± –±–æ–Ω—É—Å</title>
              <style>
                  * { margin: 0; padding: 0; box-sizing: border-box; }
                  body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: #f5f5f5; }
                  .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
                  h1 { font-size: 2.5em; margin: 30px 0; }
                  h2 { font-size: 1.8em; margin: 30px 0 15px 0; border-bottom: 3px solid #FF6B35; }
                  p { margin: 15px 0; line-height: 1.8; }
                  .cta-button { background: #FF6B35; color: white; padding: 15px 30px; border-radius: 5px; text-decoration: none; font-weight: bold; display: inline-block; }
                  table { width: 100%; border-collapse: collapse; margin: 20px 0; background: white; }
                  th, td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; }
                  th { background: #FF6B35; color: white; }
                  .ref-links { text-align: center; margin: 30px 0; padding: 20px; background: #f0f0f0; }
              </style>
          </head>
          <body>
              <div class="container">
                  <h1>üé∞ {{ item[1] | upper }} Casino</h1>
                  
                  <p><strong>{{ item[1] | upper }} casino</strong> ‚Äî –ø—Ä–µ–º–∏–∞–ª—å–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ —Å –ª–∏—Ü–µ–Ω–∑–∏–µ–π Curacao. –ù–∞ —Å–∞–π—Ç–µ 7200+ —Å–ª–æ—Ç–æ–≤. <strong>–ö–∞–∑–∏–Ω–æ {{ item[1] | upper }}</strong> –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –≤—ã–≤–æ–¥ –∑–∞ 15-30 –º–∏–Ω—É—Ç –∏ –ø–æ–¥–¥–µ—Ä–∂–∫—É 24/7 –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.</p>
                  
                  <p><strong>{{ item[1] | title }} casino</strong> –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ª—É—á—à–∏–µ —É—Å–ª–æ–≤–∏—è: 100% –±–æ–Ω—É—Å –¥–æ 50,000 —Ä—É–±–ª–µ–π + 100 —Ñ—Ä–∏—Å–ø–∏–Ω–æ–≤. –í—Å–µ –∏–≥—Ä—ã —á–µ—Å—Ç–Ω—ã–µ —Å —Å–µ—Ä—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º RNG. –†–µ–π—Ç–∏–Ω–≥ 4.8‚òÖ –æ—Ç 5000+ –∏–≥—Ä–æ–∫–æ–≤.</p>
                  
                  <a href="./register/" class="cta-button">‚Üí –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ +50,000 —Ä—É–±–ª–µ–π</a>
                  
                  <h2>–ü–æ—á–µ–º—É –≤—ã–±–∏—Ä–∞—é—Ç {{ item[1] | upper }} Casino?</h2>
                  <p><strong>{{ item[1] | upper }} –∫–∞–∑–∏–Ω–æ</strong> –∑–∞–≤–æ–µ–≤–∞–ª–æ —Ä–µ–ø—É—Ç–∞—Ü–∏—é —á–µ—Å—Ç–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–π. –ù–∞ {{ item[1] | upper }} casino —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–µ—Ä—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π RNG –æ—Ç iTech Labs. –õ–∏—Ü–µ–Ω–∑–∏—è Curacao eGaming –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –ª–µ–≥–∞–ª—å–Ω–æ—Å—Ç—å –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.</p>
                  
                  <table>
                      <tr><th>–ü–∞—Ä–∞–º–µ—Ç—Ä</th><th>{{ item[1] | upper }} Casino</th></tr>
                      <tr><td>üìú –õ–∏—Ü–µ–Ω–∑–∏—è</td><td>Curacao eGaming ‚úÖ</td></tr>
                      <tr><td>üé∞ –ò–≥—Ä–æ–≤—ã—Ö –∞–≤—Ç–æ–º–∞—Ç–æ–≤</td><td>7200+ —Å–ª–æ—Ç–æ–≤</td></tr>
                      <tr><td>üí≥ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –¥–µ–ø–æ–∑–∏—Ç</td><td>100 —Ä—É–±–ª–µ–π</td></tr>
                      <tr><td>‚ö° –°–∫–æ—Ä–æ—Å—Ç—å –≤—ã–≤–æ–¥–∞</td><td>15-30 –º–∏–Ω—É—Ç</td></tr>
                      <tr><td>üéÅ –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –±–æ–Ω—É—Å</td><td>100% –¥–æ 50,000 —Ä—É–± + 100 FS</td></tr>
                      <tr><td>üí¨ –ü–æ–¥–¥–µ—Ä–∂–∫–∞</td><td>24/7 –Ω–∞ —Ä—É—Å—Å–∫–æ–º</td></tr>
                  </table>
                  
                  <h2>–°–ø–æ—Å–æ–±—ã –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–∞ {{ item[1] | upper }} casino</h2>
                  <table>
                      <tr><th>üí≥ –ú–µ—Ç–æ–¥ –ø–ª–∞—Ç–µ–∂–∞</th><th>üí∞ –ú–∏–Ω–∏–º—É–º</th><th>‚ö° –°–∫–æ—Ä–æ—Å—Ç—å</th></tr>
                      <tr><td>–°–ë–ü</td><td>1,500 —Ä—É–±</td><td>–ú–≥–Ω–æ–≤–µ–Ω–Ω–æ</td></tr>
                      <tr><td>Joker Wallet</td><td>150 —Ä—É–±</td><td>5-10 –º–∏–Ω—É—Ç</td></tr>
                      <tr><td>–ö–∞—Ä—Ç–∞ Visa/Mastercard</td><td>100 —Ä—É–±</td><td>15-30 –º–∏–Ω—É—Ç</td></tr>
                      <tr><td>–ö—Ä–∏–ø—Ç–æ (USDT, BTC)</td><td>15 EUR</td><td>5-15 –º–∏–Ω—É—Ç</td></tr>
                  </table>
                  
                  <div class="ref-links">
                      {{ ref_links | safe }}
                  </div>
                  
                  <div style="text-align: center; margin-top: 40px; padding: 20px; background: #f0f0f0;">
                      <a href="./" style="margin: 0 15px; color: #FF6B35; text-decoration: none; font-weight: bold;">–ì–ª–∞–≤–Ω–∞—è</a>
                      <a href="./register/" style="margin: 0 15px; color: #FF6B35; text-decoration: none; font-weight: bold;">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
                      <a href="./reviews/" style="margin: 0 15px; color: #FF6B35; text-decoration: none; font-weight: bold;">–û—Ç–∑—ã–≤—ã</a>
                      <a href="./bonus/" style="margin: 0 15px; color: #FF6B35; text-decoration: none; font-weight: bold;">–ë–æ–Ω—É—Å—ã</a>
                      <a href="./withdrawal/" style="margin: 0 15px; color: #FF6B35; text-decoration: none; font-weight: bold;">–í—ã–≤–æ–¥</a>
                  </div>
              </div>
          </body>
          </html>
        dest: "/var/www/{{ item[0] }}/{{ item[1] }}/index.html"
        owner: www-data
        group: www-data
        mode: '0644'
      loop: "{{ domains | product(brands) | list }}"

    - name: Generate register.html
      copy:
        content: |
          <!DOCTYPE html>
          <html lang="ru">
          <head>
              <meta charset="UTF-8">
              <link rel="canonical" href="https://{{ item[0] }}/{{ item[1] | lower }}/register/">
              <title>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ {{ item[1] | upper }} Casino</title>
          </head>
          <body style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: #f5f5f5; margin: 0; padding: 20px;">
              <div style="max-width: 1200px; margin: 0 auto;">
                  <h1>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ {{ item[1] | upper }} Casino</h1>
                  <p>–†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Å—è –∑–∞ 90 —Å–µ–∫—É–Ω–¥ –∏ –ø–æ–ª—É—á–∏ 50,000 —Ä—É–±–ª–µ–π –±–æ–Ω—É—Å–∞!</p>
                  <ol style="margin-left: 20px;"><li>–ù–∞–∂–º–∏ "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è"</li><li>Email + –ø–∞—Ä–æ–ª—å</li><li>–õ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</li><li>–ü–æ–ø–æ–ª–Ω–∏ —Å—á—ë—Ç</li><li>–ü–æ–ª—É—á–∏ –±–æ–Ω—É—Å!</li></ol>
                  <div style="text-align: center; margin-top: 30px;">
                      <a href="./" style="margin-right: 20px; color: #FF6B35; font-weight: bold;">‚Üê –ì–ª–∞–≤–Ω–∞—è</a>
                      <a href="../reviews/" style="color: #FF6B35; font-weight: bold;">–û—Ç–∑—ã–≤—ã ‚Üí</a>
                  </div>
              </div>
          </body>
          </html>
        dest: "/var/www/{{ item[0] }}/{{ item[1] }}/register/index.html"
        owner: www-data
        group: www-data
        mode: '0644'
      loop: "{{ domains | product(brands) | list }}"

    - name: Generate reviews.html
      copy:
        content: |
          <!DOCTYPE html>
          <html lang="ru">
          <head>
              <meta charset="UTF-8">
              <link rel="canonical" href="https://{{ item[0] }}/{{ item[1] | lower }}/reviews/">
              <title>–û—Ç–∑—ã–≤—ã –æ {{ item[1] | upper }} Casino - 4.8‚òÖ</title>
          </head>
          <body style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: #f5f5f5; margin: 0; padding: 20px;">
              <div style="max-width: 1200px; margin: 0 auto;">
                  <h1>–û—Ç–∑—ã–≤—ã –æ {{ item[1] | upper }} Casino</h1>
                  <p>‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê –†–µ–π—Ç–∏–Ω–≥: 4.8/5.0 (5000+ –æ—Ç–∑—ã–≤–æ–≤)</p>
                  <div style="background: white; padding: 20px; margin: 15px 0; border-left: 4px solid #FF6B35;">
                      <strong>–ò–≤–∞–Ω –ö.:</strong> "–í—ã–∏–≥—Ä–∞–ª 250,000 —Ä—É–±–ª–µ–π! –í—ã–≤–æ–¥ –∑–∞ 20 –º–∏–Ω—É—Ç. ‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ"
                  </div>
                  <div style="text-align: center; margin-top: 30px;">
                      <a href="../bonus/" style="margin-right: 20px; color: #FF6B35; font-weight: bold;">‚Üê –ë–æ–Ω—É—Å—ã</a>
                      <a href="../withdrawal/" style="color: #FF6B35; font-weight: bold;">–í—ã–≤–æ–¥ ‚Üí</a>
                  </div>
              </div>
          </body>
          </html>
        dest: "/var/www/{{ item[0] }}/{{ item[1] }}/reviews/index.html"
        owner: www-data
        group: www-data
        mode: '0644'
      loop: "{{ domains | product(brands) | list }}"

    - name: Generate bonus.html
      copy:
        content: |
          <!DOCTYPE html>
          <html lang="ru">
          <head>
              <meta charset="UTF-8">
              <link rel="canonical" href="https://{{ item[0] }}/{{ item[1] | lower }}/bonus/">
              <title>–ë–æ–Ω—É—Å—ã –≤ {{ item[1] | upper }} Casino</title>
          </head>
          <body style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: #f5f5f5; margin: 0; padding: 20px;">
              <div style="max-width: 1200px; margin: 0 auto;">
                  <h1>–ë–æ–Ω—É—Å—ã –≤ {{ item[1] | upper }} Casino</h1>
                  <p>100% –¥–æ 50,000 —Ä—É–±–ª–µ–π + 100 —Ñ—Ä–∏—Å–ø–∏–Ω–æ–≤!</p>
                  <div style="text-align: center; margin-top: 30px;">
                      <a href="../reviews/" style="margin-right: 20px; color: #FF6B35; font-weight: bold;">‚Üê –û—Ç–∑—ã–≤—ã</a>
                      <a href="../withdrawal/" style="color: #FF6B35; font-weight: bold;">–í—ã–≤–æ–¥ ‚Üí</a>
                  </div>
              </div>
          </body>
          </html>
        dest: "/var/www/{{ item[0] }}/{{ item[1] }}/bonus/index.html"
        owner: www-data
        group: www-data
        mode: '0644'
      loop: "{{ domains | product(brands) | list }}"

    - name: Generate withdrawal.html
      copy:
        content: |
          <!DOCTYPE html>
          <html lang="ru">
          <head>
              <meta charset="UTF-8">
              <link rel="canonical" href="https://{{ item[0] }}/{{ item[1] | lower }}/withdrawal/">
              <title>–í—ã–≤–æ–¥ –¥–µ–Ω–µ–≥ –∏–∑ {{ item[1] | upper }} Casino</title>
          </head>
          <body style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: #f5f5f5; margin: 0; padding: 20px;">
              <div style="max-width: 1200px; margin: 0 auto;">
                  <h1>–í—ã–≤–æ–¥ –¥–µ–Ω–µ–≥ –∏–∑ {{ item[1] | upper }} Casino</h1>
                  <p>15-30 –º–∏–Ω—É—Ç! –°–ë–ü, Joker, –∫–∞—Ä—Ç—ã, –∫—Ä–∏–ø—Ç–æ - 0% –∫–æ–º–∏—Å—Å–∏—è!</p>
                  <div style="text-align: center; margin-top: 30px;">
                      <a href="../bonus/" style="margin-right: 20px; color: #FF6B35; font-weight: bold;">‚Üê –ë–æ–Ω—É—Å—ã</a>
                      <a href="../" style="color: #FF6B35; font-weight: bold;">–ù–∞ –≥–ª–∞–≤–Ω—É—é ‚Üí</a>
                  </div>
              </div>
          </body>
          </html>
        dest: "/var/www/{{ item[0] }}/{{ item[1] }}/withdrawal/index.html"
        owner: www-data
        group: www-data
        mode: '0644'
      loop: "{{ domains | product(brands) | list }}"

    # ========== –ò–¢–û–ì–ò ==========
    - name: Summary
      debug:
        msg: |
          ‚úÖ –ì–ï–ù–ï–†–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê!
          üìä –°–æ–∑–¥–∞–Ω–æ:
            - –î–æ–º–µ–Ω—ã: {{ domains | length }}
            - –ë—Ä–µ–Ω–¥—ã: {{ brands | length }}
            - –í—Å–µ–≥–æ: {{ (domains | length) * (brands | length) * 5 }} —Å—Ç—Ä–∞–Ω–∏—Ü
            - –°—Ç—Ä–∞–Ω–∏—Ü—ã –≤ –∫–∞–∂–¥–æ–º –∫–∞–∑–∏–Ω–æ: index.html, register/index.html, reviews/index.html, bonus/index.html, withdrawal/index.html
      run_once: true
